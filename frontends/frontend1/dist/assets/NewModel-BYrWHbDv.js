import{_ as g,E as w,c as v,b as n,d as l,e as o,h as p,o as V,q as h}from"./index-BGBuXAIC.js";const b={data(){return{newmodelcanshu:[],formulaall:"",result:"",fileList:[]}},created(){this.formulaall=this.$route.query.Total,this.extractParameters(this.formulaall)},methods:{addItem(){this.newmodelcanshu.push({canshu:"",zhi:""})},calculate(){const t=this.combineFormulas(this.newmodelcanshu),e={};t.forEach((a,r)=>{e[r]=a}),this.$http.post("http://47.97.176.174:8087/chainmaker?cmb=Calculate",{companyId:this.$store.state.companyData.CompanyID,expression:this.formulaall,values:e}).then(a=>{console.log(a.data),this.result=a.data.data,w({message:"计算成功！",type:"success"})}).catch(a=>{console.log(a)})},extractParameters(t){const e=/[a-zA-Z]+/g,a=t.match(e);[...new Set(a)].forEach(i=>{this.newmodelcanshu.push({canshu:i,zhi:""})})},combineFormulas(t){const e=new Map;return t.forEach(a=>{const r=parseFloat(a.zhi);isNaN(r)||e.set(a.canshu,r)}),e},handleRemove(t,e){console.log(t,e)},handlePreview(t){console.log(t)},handleFileChange(t,e){this.fileList=e,console.log(this.fileList)},async customUpload(){if(this.fileList.length===0){alert("请先选择文件！");return}const t=new FormData;this.fileList.forEach(e=>{t.append("files[]",e.raw),t.append("CompanyId",this.$store.state.companyData.CompanyID)});try{this.$http.post("http://47.97.176.174:8087/chainmaker?cmb=TransmissionPGEFile",t,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.$router.push({name:"SuccessUpload"})})}catch(e){console.error("上传失败:",e)}}}},C={style:{display:"flex"}},z=n("text",{style:{"font-size":"30px"}},"自定义模型",-1),k={style:{display:"flex","margin-left":"20px","margin-top":"20px"}},U=n("span",{style:{"font-size":"25px"}},"公式：",-1),E={style:{display:"flex","margin-left":"100px"}},F={style:{display:"flex","margin-left":"100px","margin-top":"20px"}},P={style:{display:"flex",height:"30px","margin-left":"50px"}},D=n("span",{style:{"font-size":"25px"}},"计算结果：",-1),I=n("text",{style:{"font-size":"30px"}},"上传新模型资料",-1),L=n("i",{class:"el-icon-plus"},null,-1);function N(t,e,a,r,i,d){const c=p("el-input"),m=p("el-button"),f=p("el-table-column"),x=p("el-table"),_=p("el-card"),y=p("el-upload");return V(),v("div",C,[n("div",null,[l(_,{style:{"margin-top":"10px","margin-left":"20px","margin-right":"20px"}},{header:o(()=>[z]),default:o(()=>[n("div",k,[U,l(c,{modelValue:i.formulaall,"onUpdate:modelValue":e[0]||(e[0]=s=>i.formulaall=s),style:{width:"400px"},disabled:""},null,8,["modelValue"])]),l(m,{type:"primary",class:"mt-4",onClick:e[1]||(e[1]=s=>d.addItem()),style:{"margin-top":"10px","margin-left":"30px"}},{default:o(()=>[h("新增参数")]),_:1}),n("div",E,[l(x,{data:i.newmodelcanshu,border:"",style:{width:"450px","margin-left":"8px","margin-top":"20px"}},{default:o(()=>[l(f,{label:"参数",width:"200"},{default:o(s=>[l(c,{modelValue:s.row.canshu,"onUpdate:modelValue":u=>s.row.canshu=u,placeholder:"请输入参数",disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(f,{label:"值",width:"250"},{default:o(s=>[l(c,{modelValue:s.row.zhi,"onUpdate:modelValue":u=>s.row.zhi=u,placeholder:"请输入值"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),n("div",F,[l(m,{type:"primary",size:"large",onClick:d.calculate},{default:o(()=>[h("计算")]),_:1},8,["onClick"]),n("div",P,[D,l(c,{modelValue:i.result,"onUpdate:modelValue":e[2]||(e[2]=s=>i.result=s),style:{width:"400px"}},null,8,["modelValue"])])])]),_:1})]),l(_,{shadow:"never",style:{"margin-top":"10px","margin-left":"20px","margin-right":"20px",width:"300px"}},{header:o(()=>[I]),default:o(()=>[l(y,{ref:"upload",class:"upload-demo",action:"https://jsonplaceholder.typicode.com/posts/","on-preview":d.handlePreview,"on-remove":d.handleRemove,"file-list":i.fileList,"list-type":"picture-card","auto-upload":!1,onChange:d.handleFileChange},{default:o(()=>[L]),_:1},8,["on-preview","on-remove","file-list","onChange"]),l(m,{type:"primary",onClick:d.customUpload,style:{"margin-top":"10px"}},{default:o(()=>[h("提交材料")]),_:1},8,["onClick"])]),_:1})])}const T=g(b,[["render",N]]);export{T as default};
