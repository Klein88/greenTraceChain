import{_ as W,u as X,j as Y,r as c,o as Z,a as p,b as tt,c as et,d,e,w as a,f as s,t as i,k as l,g as at,p as ot,h as nt}from"./index-Dqiu3Z7p.js";const y=g=>(ot("data-v-90e1b370"),g=g(),nt(),g),st={class:"traceSource1",style:{display:"flex","flex-direction":"column"}},lt={style:{display:"flex","justify-content":"center","align-items":"center",margin:"40px 20px 0 20px",padding:"20px 0 20px 0",background:"white","border-radius":"3px"}},ct={style:{display:"flex","justify-content":"space-around","align-items":"center"}},it={style:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center","margin-top":"20px"}},rt=y(()=>d("span",{style:{"font-size":"20px","font-weight":"bold"}},"公司详情",-1)),dt={style:{"margin-top":"15px"}},ut={style:{display:"flex","flex-direction":"column","justify-content":"center",height:"250px"}},pt={style:{display:"flex","align-items":"center","justify-content":"space-between"}},_t=y(()=>d("span",{style:{"font-size":"20px","font-weight":"bold"}},"发布详情",-1)),mt={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-left":"10px","margin-right":"20px"}},yt=y(()=>d("span",{style:{"font-size":"17px","font-weight":"bold"}},"最新记录",-1)),gt=y(()=>d("span",{class:"custom-label"},"区块高度",-1)),ht=y(()=>d("span",{class:"custom-label"},"区块时间戳",-1)),vt={__name:"TraceSource1",setup(g){const v=X(),_=Y(),$=at(),{proxy:f}=$,z=_.query.Id;let x=c("");const J=_.query.CompanyId;let b=c("");const O=_.query.createAt,V=_.query.updateAt;let t=c({});const I=c([]),S=c(""),D=c(-1),w=c(-1),C=c(""),T=c(""),k=c(""),A=c([]),j=c(""),q=c(""),B=c(0),N=c(""),F=o=>{switch(o){case"0":return"未审核";case"1":return"已审核通过";case"2":return"未审核通过";default:return""}},M=o=>{switch(o){case"0":return"电网企业";case"1":return"化工企业";default:return""}};Z(async()=>{x.value=F(_.query.State),b.value=M(_.query.Type),t.value.Id=z,t.value.State=x.value,t.value.CompanyId=J,t.value.Type=b.value,t.value.createAt=O,t.value.updateAt=V,await f.$axios.post("http://47.97.176.174:8087/chainmaker?cmb=SearchAllTransactionDataByCompanyId",{CompanyId:t.value.CompanyId}).then(n=>{console.log(n),I.value=[...n.data.data]}),t.value.tracesourceData=I.value,await f.$axios.post("http://47.97.176.174:8087/chainmaker?cmb=TxIdToSearchTx",{Txid:t.value.tracesourceData[t.value.tracesourceData.length-1].Txid}).then(n=>{console.log(n),S.value=t.value.tracesourceData[t.value.tracesourceData.length-1].Txid,D.value=n.data.data.block_height,w.value=n.data.data.block_timestamp,C.value=n.data.data.transaction.payload.chain_id,T.value=n.data.data.transaction.payload.contract_name,k.value=n.data.data.transaction.payload.method;const m=[];for(let u=0;u<n.data.data.transaction.payload.parameters.length;u++)m.push(n.data.data.transaction.payload.parameters[u].key);A.value=[...m],j.value=n.data.data.transaction.payload.tx_id,q.value=n.data.data.transaction.result.contract_result.message,B.value=n.data.data.transaction.result.contract_result.gas_used,N.value=n.data.data.transaction.sender.signer.org_id}),t.value.Txid=S.value,t.value.block_height=D.value,t.value.block_timestamp=w.value,t.value.chain_id=C.value,t.value.contract_name=T.value,t.value.method=k.value,t.value.parameters=A.value,t.value.tx_id=j.value,t.value.contract_result_message=q.value,t.value.gas_used=B.value,t.value.org_id=N.value;const o=U();o&&(t.value=o)});const E=()=>{sessionStorage.removeItem("myData1"),sessionStorage.removeItem("myData2"),sessionStorage.removeItem("myData3"),sessionStorage.removeItem("myData4"),v.push("/carbonAccountingData")},G=o=>{sessionStorage.setItem("myData1",JSON.stringify(o)),console.log(o.CompanyId),v.push({path:"/traceSource3/"+o.CompanyId,query:{Id:o.Id,CompanyId:o.CompanyId,Txid:o.Txid}})},L=o=>{sessionStorage.setItem("myData1",JSON.stringify(o)),v.push({path:"/traceSource2/"+o.CompanyId,query:{Id:o.Id,CompanyId:o.CompanyId}})},U=()=>{const o=sessionStorage.getItem("myData1");return o?JSON.parse(o):null};return(o,n)=>{const m=p("el-button"),u=p("el-step"),H=p("el-steps"),r=p("el-descriptions-item"),R=p("el-descriptions"),h=p("el-card"),K=p("ArrowRightBold"),P=p("el-icon");return tt(),et("div",st,[d("div",lt,[e(m,{type:"primary",icon:"ArrowLeftBold",onClick:E,style:{width:"120px","margin-left":"30px"}},{default:a(()=>[s("返回")]),_:1}),e(H,{active:6,style:{width:"90%"},"align-center":""},{default:a(()=>[e(u,{title:"评估中",icon:"Document"}),e(u,{title:"待发布",icon:"DocumentCopy"}),e(u,{title:"发布中",icon:"Upload"}),e(u,{title:"签约中",icon:"Memo"}),e(u,{title:"认证中",icon:"DocumentChecked"}),e(u,{title:"已完成",icon:"Finished"})]),_:1})]),d("div",ct,[e(h,{style:{width:"250px",height:"420px","margin-top":"18px"}},{default:a(()=>[d("div",it,[rt,d("span",dt,"状态："+i(l(t).State),1)]),d("div",ut,[e(h,{style:{height:"250px","margin-top":"50px",display:"flex","flex-direction":"column","justify-content":"center"}},{default:a(()=>[e(R,{column:1},{default:a(()=>[e(r,{label:"公司编号"},{default:a(()=>[s(i(l(t).CompanyId),1)]),_:1}),e(r,{label:"企业类型"},{default:a(()=>[s(i(l(t).Type),1)]),_:1}),e(r,{label:"创建时间"},{default:a(()=>[s(i(l(t).createAt),1)]),_:1}),e(r,{label:"更新时间"},{default:a(()=>[s(i(l(t).updateAt),1)]),_:1})]),_:1})]),_:1})])]),_:1}),e(h,{style:{width:"750px","margin-top":"50px","margin-bottom":"35px","margin-right":"30px"}},{default:a(()=>[d("div",pt,[_t,e(m,{type:"primary",text:"",onClick:n[0]||(n[0]=Q=>L(l(t)))},{default:a(()=>[s(" 更多 "),e(P,{class:"el-icon--right"},{default:a(()=>[e(K)]),_:1})]),_:1})]),e(h,{style:{"margin-top":"20px"}},{default:a(()=>[d("div",mt,[yt,e(m,{type:"primary",text:"",style:{"margin-left":"20px"},onClick:n[1]||(n[1]=Q=>G(l(t)))},{default:a(()=>[s("溯源")]),_:1})]),e(R,{border:"",column:2,style:{"margin-top":"15px"}},{default:a(()=>[e(r,{width:"120"},{label:a(()=>[gt]),default:a(()=>[s(" "+i(l(t).block_height),1)]),_:1}),e(r,{width:"120"},{label:a(()=>[ht]),default:a(()=>[s(" "+i(l(t).block_timestamp),1)]),_:1}),e(r,{label:"区块链ID"},{default:a(()=>[s(i(l(t).chain_id),1)]),_:1}),e(r,{label:"交易发起组织"},{default:a(()=>[s(i(l(t).org_id),1)]),_:1}),e(r,{label:"合约名称"},{default:a(()=>[s(i(l(t).contract_name),1)]),_:1}),e(r,{label:"合约调用方法"},{default:a(()=>[s(i(l(t).method),1)]),_:1}),e(r,{label:"合约调用参数",span:2},{default:a(()=>[s(i(l(t).parameters),1)]),_:1}),e(r,{label:"合约执行结果"},{default:a(()=>[s(i(l(t).contract_result_message),1)]),_:1}),e(r,{label:"消耗GAS量"},{default:a(()=>[s(i(l(t).gas_used),1)]),_:1}),e(r,{label:"交易ID",span:2},{default:a(()=>[s(i(l(t).tx_id),1)]),_:1})]),_:1})]),_:1})]),_:1})])])}}},xt=W(vt,[["__scopeId","data-v-90e1b370"]]);export{xt as default};
