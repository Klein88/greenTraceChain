import{_ as U,j as W,u as X,r as a,o as Y,a as p,b as D,c as j,d as C,e as l,w as o,F as Z,l as aa,f as u,m as ta,t as d,g as ea}from"./index-Dqiu3Z7p.js";const sa={class:"traceSource2"},oa={style:{display:"flex","flex-direction":"row","margin-top":"30px"}},la={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-left":"10px","margin-right":"30px"}},na={style:{"font-size":"17px","font-weight":"bold"}},ca={__name:"TraceSource2",setup(ua){const w=W(),m=X(),R=ea(),{proxy:T}=R,t=a({}),z=w.query.Id,E=w.query.CompanyId,v=a([]),N=a(-1),A=a(-1),B=a(""),q=a(""),$=a(""),F=a([]),J=a(""),L=a(""),O=a(0),V=a(""),_=a([]),h=a([]),g=a([]),y=a([]),f=a([]),b=a([]),I=a([]),x=a([]),S=a([]),k=a([]);Y(async()=>{t.value.Id=z,t.value.CompanyId=E,await T.$axios.post("http://47.97.176.174:8087/chainmaker?cmb=SearchAllTransactionDataByCompanyId",{CompanyId:t.value.CompanyId}).then(r=>{console.log(r),v.value=[...r.data.data]}),t.value.tracesourceData=v.value;for(let r=0;r<t.value.tracesourceData.length;r++)await T.$axios.post("http://47.97.176.174:8087/chainmaker?cmb=TxIdToSearchTx",{Txid:t.value.tracesourceData[r].Txid}).then(e=>{console.log(e),N.value=e.data.data.block_height,A.value=e.data.data.block_timestamp,B.value=e.data.data.transaction.payload.chain_id,q.value=e.data.data.transaction.payload.contract_name,$.value=e.data.data.transaction.payload.method;const n=[];for(let i=0;i<e.data.data.transaction.payload.parameters.length;i++)n.push(e.data.data.transaction.payload.parameters[i].key);F.value=[...n],J.value=e.data.data.transaction.payload.tx_id,L.value=e.data.data.transaction.result.contract_result.message,O.value=e.data.data.transaction.result.contract_result.gas_used,V.value=e.data.data.transaction.sender.signer.org_id,_.value.push(N.value),h.value.push(A.value),g.value.push(B.value),y.value.push(q.value),f.value.push($.value),b.value.push(F.value),I.value.push(J.value),x.value.push(L.value),S.value.push(O.value),k.value.push(V.value)});t.value.block_heights=_.value,t.value.block_timestamps=h.value,t.value.chain_ids=g.value,t.value.contract_names=y.value,t.value.methods=f.value,t.value.parameterses=b.value,t.value.tx_ids=I.value,t.value.contract_result_messages=x.value,t.value.gas_useds=S.value,t.value.org_ids=k.value;const s=K();s&&(t.value=s)});const G=s=>{sessionStorage.setItem("myData2",JSON.stringify(s)),m.push("/traceSource1/"+s.CompanyId)},M=()=>{sessionStorage.removeItem("myData1"),sessionStorage.removeItem("myData2"),sessionStorage.removeItem("myData3"),sessionStorage.removeItem("myData4"),m.push("/carbonAccountingData")},H=(s,r)=>{sessionStorage.setItem("myData2",JSON.stringify(s)),m.push({path:"/traceSource3/"+s.CompanyId,query:{Id:s.Id,CompanyId:s.CompanyId,Txid:s.tx_ids[r]}})},K=()=>{const s=sessionStorage.getItem("myData2");return s?JSON.parse(s):null};return(s,r)=>{const e=p("el-button"),n=p("el-descriptions-item"),i=p("el-descriptions"),P=p("el-card");return D(),j("div",sa,[C("div",oa,[l(e,{type:"primary",icon:"ArrowLeft",onClick:r[0]||(r[0]=Q=>G(t.value)),style:{width:"120px","margin-left":"20px"}},{default:o(()=>[u("返回")]),_:1}),l(e,{type:"default",icon:"DArrowLeft",onClick:M,style:{width:"120px","margin-left":"20px"}},{default:o(()=>[u("退出")]),_:1})]),(D(!0),j(Z,null,aa(v.value.length,(Q,c)=>(D(),ta(P,{style:{margin:"30px 20px 30px 20px"},key:c},{default:o(()=>[C("div",la,[C("span",na,"记录 "+d(c+1),1),l(e,{type:"primary",text:"",style:{"margin-left":"20px"},onClick:ra=>H(t.value,c)},{default:o(()=>[u("溯源")]),_:2},1032,["onClick"])]),l(i,{border:"",column:2,style:{"margin-top":"15px"}},{default:o(()=>[l(n,{label:"区块高度",width:"120"},{default:o(()=>[u(d(_.value[c]),1)]),_:2},1024),l(n,{label:"区块时间戳",width:"100"},{default:o(()=>[u(d(h.value[c]),1)]),_:2},1024),l(n,{label:"区块链ID"},{default:o(()=>[u(d(g.value[c]),1)]),_:2},1024),l(n,{label:"交易发起组织"},{default:o(()=>[u(d(k.value[c]),1)]),_:2},1024),l(n,{label:"合约名称"},{default:o(()=>[u(d(y.value[c]),1)]),_:2},1024),l(n,{label:"合约调用方法"},{default:o(()=>[u(d(f.value[c]),1)]),_:2},1024),l(n,{label:"合约调用参数",span:2},{default:o(()=>[u(d(b.value[c]),1)]),_:2},1024),l(n,{label:"合约执行结果"},{default:o(()=>[u(d(x.value[c]),1)]),_:2},1024),l(n,{label:"消耗GAS量"},{default:o(()=>[u(d(S.value[c]),1)]),_:2},1024),l(n,{label:"交易ID",span:2},{default:o(()=>[u(d(I.value[c]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])}}},ia=U(ca,[["__scopeId","data-v-d52db263"]]);export{ia as default};
